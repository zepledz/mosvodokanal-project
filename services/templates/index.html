<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ—Å–≤–æ–¥–æ–∫–∞–Ω–∞–ª - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –≤–æ–¥—ã</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .anomaly { background-color: #ffebee; }
        .normal { background-color: #e8f5e8; }
        .card { margin-bottom: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; }
        .table-responsive { max-height: 500px; }
        .status-alert { color: #d32f2f; }
        .status-ok { color: #388e3c; }
        .websocket-connected { color: #388e3c; }
        .websocket-disconnected { color: #d32f2f; }
        .loading { opacity: 0.6; }
        .risk-high { background-color: #ffebee !important; }
        .risk-medium { background-color: #fff3e0 !important; }
        .risk-low { background-color: #e8f5e8 !important; }
        .card-header { background-color: #f8f9fa; border-bottom: 1px solid #e0e0e0; font-weight: 600; }
        .form-label { font-weight: 500; margin-bottom: 0.5rem; }
        canvas { max-height: 300px; }
        .table th { font-size: 0.85rem; }
        .table td { font-size: 0.82rem; }
        .badge { font-size: 0.75rem; }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—Ö–æ–¥–∞ */
        .modal {
            backdrop-filter: blur(5px);
        }
        .modal-content {
            border: none;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
    <div id="login-modal" class="modal fade show" style="display: block; background-color: rgba(0,0,0,0.5);" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-tint"></i> –ú–æ—Å–≤–æ–¥–æ–∫–∞–Ω–∞–ª - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
                    </h5>
                </div>
                <div class="modal-body">
                    <div id="login-alert" class="alert alert-danger d-none"></div>
                    <form id="login-form">
                        <div class="mb-3">
                            <label for="login-username" class="form-label">–õ–æ–≥–∏–Ω:</label>
                            <input type="text" class="form-control" id="login-username" required
                                   value="admin" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω">
                        </div>
                        <div class="mb-3">
                            <label for="login-password" class="form-label">–ü–∞—Ä–æ–ª—å:</label>
                            <input type="password" class="form-control" id="login-password" required
                                   value="admin123" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary" id="login-btn">
                                <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
                            </button>
                        </div>
                    </form>
                    <div class="mt-3 text-center">
                        <small class="text-muted">
                            –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:<br>
                            admin/admin123 (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)<br>
                            dispatcher/dispatcher123 (–î–∏—Å–ø–µ—Ç—á–µ—Ä)
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) -->
    <div id="main-content" style="display: none;">
        <nav class="navbar navbar-dark bg-primary">
            <div class="container-fluid">
                <span class="navbar-brand mb-0 h1">
                    <i class="fas fa-tint"></i> –ú–æ—Å–≤–æ–¥–æ–∫–∞–Ω–∞–ª - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –≤–æ–¥—ã
                </span>
                <span class="navbar-text">
                    <span id="user-info" class="me-3"></span>
                    <button class="btn btn-warning btn-sm" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
                    </button>
                    &nbsp;|&nbsp;
                    <span id="websocket-status" class="websocket-disconnected" title="WebSocket –æ—Ç–∫–ª—é—á–µ–Ω">
                        <i class="fas fa-plug"></i> WebSocket: ‚ùå
                    </span>
                    &nbsp;|&nbsp;
                    –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="update-time">-</span>
                    &nbsp;|&nbsp;
                    <button class="btn btn-warning btn-sm" onclick="testConnection()">
                        <i class="fas fa-bug"></i> –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
                    </button>
                </span>
            </div>
        </nav>

        <div class="container-fluid mt-4">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="row mb-4">
                <div class="col-md-2">
                    <div class="card bg-primary text-white">
                        <div class="card-body">
                            <h5 class="card-title">–í—Å–µ–≥–æ –∑–¥–∞–Ω–∏–π</h5>
                            <h2 id="total-buildings">0</h2>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card bg-success text-white">
                        <div class="card-body">
                            <h5 class="card-title">–í—Å–µ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π</h5>
                            <h2 id="total-measurements">0</h2>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card bg-warning text-white">
                        <div class="card-body">
                            <h5 class="card-title">–ê–Ω–æ–º–∞–ª–∏–π</h5>
                            <h2 id="total-anomalies">0</h2>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card bg-info text-white">
                        <div class="card-body">
                            <h5 class="card-title">% –ê–Ω–æ–º–∞–ª–∏–π</h5>
                            <h2 id="anomaly-percentage">0%</h2>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card bg-secondary text-white">
                        <div class="card-body">
                            <h5 class="card-title">–ù–æ—Ä–º–∞–ª—å–Ω—ã–µ</h5>
                            <h2 id="normal-count">0</h2>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="card bg-dark text-white">
                        <div class="card-body">
                            <h5 class="card-title">–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h5>
                            <h2 id="system-status">üü¢</h2>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="realtime-tab" data-bs-toggle="tab" href="#realtime" role="tab">
                        <i class="fas fa-bolt"></i> Real-time –¥–∞–Ω–Ω—ã–µ
                        <span id="realtime-badge" class="badge bg-success">0</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="historical-tab" data-bs-toggle="tab" href="#historical" role="tab">
                        <i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="buildings-tab" data-bs-toggle="tab" href="#buildings" role="tab">
                        <i class="fas fa-building"></i> –°–ø–∏—Å–æ–∫ –∑–¥–∞–Ω–∏–π
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="predictions-tab" data-bs-toggle="tab" href="#predictions" role="tab">
                        <i class="fas fa-chart-line"></i> –ü—Ä–æ–≥–Ω–æ–∑—ã —Ä–∏—Å–∫–æ–≤
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="charts-tab" data-bs-toggle="tab" href="#charts" role="tab">
                        <i class="fas fa-chart-bar"></i> –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
                    </a>
                </li>
            </ul>

            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–æ–∫ -->
            <div class="tab-content" id="myTabContent">
                <!-- Real-time –¥–∞–Ω–Ω—ã–µ -->
                <div class="tab-pane fade show active" id="realtime" role="tabpanel">
                    <div class="mt-3">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h4>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</h4>
                            <div>
                                <button class="btn btn-outline-primary btn-sm" onclick="clearRealtimeTable()">
                                    <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" onclick="loadLastRealtimeData()">
                                    <i class="fas fa-sync"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ
                                </button>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>–ê–¥—Ä–µ—Å</th>
                                        <th>–•–í–° (–º¬≥)</th>
                                        <th>–ì–í–° –æ–±—â–µ–µ (–º¬≥)</th>
                                        <th>–ì–í–° –∫–∞–Ω–∞–ª 1 (–º¬≥)</th>
                                        <th>–ì–í–° –∫–∞–Ω–∞–ª 2 (–º¬≥)</th>
                                        <th>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th>–í—Ä–µ–º—è</th>
                                        <th>–°—Ü–µ–Ω–∞—Ä–∏–π</th>
                                    </tr>
                                </thead>
                                <tbody id="realtime-data">
                                    <tr id="realtime-loading">
                                        <td colspan="9" class="text-center">
                                            <div class="spinner-border spinner-border-sm" role="status"></div>
                                            –û–∂–∏–¥–∞–Ω–∏–µ real-time –¥–∞–Ω–Ω—ã—Ö...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ -->
                <div class="tab-pane fade" id="historical" role="tabpanel">
                    <div class="mt-3">
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <button class="btn btn-primary" onclick="loadHistoricalData()" id="historical-btn">
                                    <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
                                </button>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select" id="history-limit" onchange="loadHistoricalData()">
                                    <option value="50">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 –∑–∞–ø–∏—Å–µ–π</option>
                                    <option value="100" selected>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 –∑–∞–ø–∏—Å–µ–π</option>
                                    <option value="200">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 200 –∑–∞–ø–∏—Å–µ–π</option>
                                </select>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>–ê–¥—Ä–µ—Å</th>
                                        <th>–•–í–° (–º¬≥)</th>
                                        <th>–ì–í–° –æ–±—â–µ–µ (–º¬≥)</th>
                                        <th>–ì–í–° –∫–∞–Ω–∞–ª 1 (–º¬≥)</th>
                                        <th>–ì–í–° –∫–∞–Ω–∞–ª 2 (–º¬≥)</th>
                                        <th>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th>–í—Ä–µ–º—è</th>
                                        <th>–°—Ü–µ–Ω–∞—Ä–∏–π</th>
                                    </tr>
                                </thead>
                                <tbody id="historical-data">
                                    <tr>
                                        <td colspan="9" class="text-center">–ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å" –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- –°–ø–∏—Å–æ–∫ –∑–¥–∞–Ω–∏–π -->
                <div class="tab-pane fade" id="buildings" role="tabpanel">
                    <div class="mt-3">
                        <button class="btn btn-primary mb-3" onclick="loadBuildings()" id="buildings-btn">
                            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–¥–∞–Ω–∏–π
                        </button>
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>ID –∑–¥–∞–Ω–∏—è</th>
                                        <th>–ê–¥—Ä–µ—Å</th>
                                        <th>–ò–¢–ü</th>
                                        <th>–í—Å–µ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π</th>
                                        <th>–ê–Ω–æ–º–∞–ª–∏–π</th>
                                        <th>% –ê–Ω–æ–º–∞–ª–∏–π</th>
                                        <th>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ</th>
                                    </tr>
                                </thead>
                                <tbody id="buildings-data">
                                    <tr>
                                        <td colspan="7" class="text-center">–ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å" –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- –ü—Ä–æ–≥–Ω–æ–∑—ã —Ä–∏—Å–∫–æ–≤ -->
                <div class="tab-pane fade" id="predictions" role="tabpanel">
                    <div class="mt-3">
                        <!-- –°–≤–æ–¥–∫–∞ –ø–æ —Ä–∏—Å–∫–∞–º -->
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="card bg-danger text-white">
                                    <div class="card-body">
                                        <h5 class="card-title">–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫</h5>
                                        <h2 id="high-risk-count">0</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-warning text-white">
                                    <div class="card-body">
                                        <h5 class="card-title">–°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫</h5>
                                        <h2 id="medium-risk-count">0</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-success text-white">
                                    <div class="card-body">
                                        <h5 class="card-title">–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫</h5>
                                        <h2 id="low-risk-count">0</h2>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <button class="btn btn-primary" onclick="loadPredictions()" id="predictions-btn">
                                    <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ã
                                </button>
                                <button class="btn btn-outline-info btn-sm" onclick="trainModel()">
                                    <i class="fas fa-brain"></i> –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å
                                </button>
                            </div>
                        </div>

                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>–ê–¥—Ä–µ—Å</th>
                                        <th>–ò–¢–ü</th>
                                        <th>–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞</th>
                                        <th>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å</th>
                                        <th>–•–í–° (–º¬≥)</th>
                                        <th>–ì–í–° (–º¬≥)</th>
                                        <th>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</th>
                                        <th>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody id="predictions-data">
                                    <tr>
                                        <td colspan="9" class="text-center">–ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ã" –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
                <div class="tab-pane fade" id="charts" role="tabpanel">
                    <div class="mt-3">
                        <!-- –§–∏–ª—å—Ç—Ä—ã -->
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <label for="building-select" class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ –∑–¥–∞–Ω–∏–µ:</label>
                                <select class="form-select" id="building-select" onchange="loadCharts()">
                                    <option value="all">–í—Å–µ –∑–¥–∞–Ω–∏—è</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="period-select" class="form-label">–ü–µ—Ä–∏–æ–¥:</label>
                                <select class="form-select" id="period-select" onchange="loadCharts()">
                                    <option value="7">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</option>
                                    <option value="30" selected>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</option>
                                    <option value="90">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">&nbsp;</label>
                                <button class="btn btn-primary w-100" onclick="loadCharts()">
                                    <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏
                                </button>
                            </div>
                        </div>

                        <!-- –ì—Ä–∞—Ñ–∏–∫–∏ -->
                        <div class="row">
                            <!-- –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º -->
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>üìä –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –•–í–° –∏ –ì–í–°</h5>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="consumptionChart" width="400" height="200"></canvas>
                                    </div>
                                </div>
                            </div>

                            <!-- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π -->
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>üö® –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π</h5>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="anomalyChart" width="400" height="200"></canvas>
                                    </div>
                                </div>
                            </div>

                            <!-- –¢—Ä–µ–Ω–¥ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è -->
                            <div class="col-md-12 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>üìà –¢—Ä–µ–Ω–¥ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–æ –¥–Ω—è–º</h5>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="trendChart" width="400" height="150"></canvas>
                                    </div>
                                </div>
                            </div>

                            <!-- –†–∏—Å–∫–∏ –ø–æ –∑–¥–∞–Ω–∏—è–º -->
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>üéØ –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞ –ø–æ –∑–¥–∞–Ω–∏—è–º</h5>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="riskChart" width="400" height="200"></canvas>
                                    </div>
                                </div>
                            </div>

                            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫ -->
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>‚è∞ –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫</h5>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="hourlyChart" width="400" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        let currentUser = null;
        let authToken = null;
        let socket = null;
        let realtimeMessageCount = 0;
        let pollingInterval = null;

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
        let consumptionChart = null;
        let anomalyChart = null;
        let trendChart = null;
        let riskChart = null;
        let hourlyChart = null;

        // ==================== –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø ====================

        // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É
        async function login(username, password) {
            const loginBtn = document.getElementById('login-btn');
            const originalText = loginBtn.innerHTML;

            try {
                loginBtn.innerHTML = '<div class="spinner-border spinner-border-sm" role="status"></div> –í—Ö–æ–¥...';
                loginBtn.disabled = true;

                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password }),
                    credentials: 'include'
                });

                const data = await response.json();

                if (response.ok) {
                    currentUser = data.user;
                    showMainContent();
                    hideLoginModal();
                    updateUserInfo();
                    initializeApplication();
                    console.log('‚úÖ –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥:', currentUser.username);
                } else {
                    showLoginError(data.error || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞');
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                showLoginError('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            } finally {
                loginBtn.innerHTML = originalText;
                loginBtn.disabled = false;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞
        async function logout() {
            try {
                await fetch('/api/auth/logout', {
                    method: 'POST',
                    credentials: 'include'
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
            } finally {
                currentUser = null;
                showLoginModal();
                hideMainContent();
                console.log('‚úÖ –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        async function checkAuth() {
            try {
                const response = await fetch('/api/auth/me', {
                    credentials: 'include'
                });

                if (response.ok) {
                    const data = await response.json();
                    currentUser = data.user;
                    showMainContent();
                    hideLoginModal();
                    updateUserInfo();
                    initializeApplication();
                } else {
                    showLoginModal();
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:', error);
                showLoginModal();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function showLoginModal() {
            document.getElementById('login-modal').style.display = 'block';
            document.getElementById('main-content').style.display = 'none';
        }

        function hideLoginModal() {
            document.getElementById('login-modal').style.display = 'none';
        }

        function showMainContent() {
            document.getElementById('main-content').style.display = 'block';
        }

        function hideMainContent() {
            document.getElementById('main-content').style.display = 'none';
        }

        function showLoginError(message) {
            const alert = document.getElementById('login-alert');
            alert.textContent = message;
            alert.classList.remove('d-none');
        }

        function hideLoginError() {
            const alert = document.getElementById('login-alert');
            alert.classList.add('d-none');
        }

        function updateUserInfo() {
            const userInfo = document.getElementById('user-info');
            if (currentUser) {
                userInfo.innerHTML = `<i class="fas fa-user"></i> ${currentUser.username} (${currentUser.role})`;
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            hideLoginError();

            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;

            login(username, password);
        });

        // –û–±–µ—Ä–Ω–µ–º –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        function initializeApplication() {
            if (!currentUser) return;

            console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', currentUser.username);

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º WebSocket
            initializeWebSocket();

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            updateStats();
            loadHistoricalData();
            loadBuildings();
            loadRiskSummary();
            loadPredictions();
            loadBuildingOptions();

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
            setInterval(updateStats, 10000);
            setInterval(loadRiskSummary, 30000);

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏
            setTimeout(() => {
                loadCharts();
            }, 1000);

            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É
            const chartsTab = document.getElementById('charts-tab');
            if (chartsTab) {
                chartsTab.addEventListener('shown.bs.tab', function() {
                    loadCharts();
                });
            }

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
            setInterval(() => {
                const chartsTab = document.getElementById('charts-tab');
                if (chartsTab && chartsTab.classList.contains('active')) {
                    loadCharts();
                }
            }, 120000);

            console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è', currentUser.username);
        }

        // –ü–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ fetch –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        const originalFetch = window.fetch;
        window.fetch = function(...args) {
            const options = args[1] || {};
            options.credentials = 'include';
            args[1] = options;

            return originalFetch.apply(this, args).then(response => {
                if (response.status === 401) {
                    // –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞
                    showLoginModal();
                    hideMainContent();
                    throw new Error('–¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è');
                }
                return response;
            });
        };

        // ==================== –°–£–©–ï–°–¢–í–£–Æ–©–ò–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ ====================

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebSocket
        function initializeWebSocket() {
            console.log('üîå –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...');

            socket = io({
                transports: ['websocket', 'polling'],
                timeout: 10000
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π WebSocket
            socket.on('connect', function() {
                console.log('‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ WebSocket');
                updateWebSocketStatus(true);
                document.getElementById('system-status').innerHTML = 'üü¢ WebSocket';
            });

            socket.on('disconnect', function(reason) {
                console.log('‚ùå –û—Ç–∫–ª—é—á–µ–Ω –æ—Ç WebSocket:', reason);
                updateWebSocketStatus(false);
                document.getElementById('system-status').innerHTML = 'üî¥ WebSocket';

                // –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                setTimeout(initializeWebSocket, 5000);
            });

            socket.on('connect_error', function(error) {
                console.log('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WebSocket:', error);
                updateWebSocketStatus(false);

                // –ï—Å–ª–∏ WebSocket –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∑–∞–ø—É—Å–∫–∞–µ–º polling
                if (!pollingInterval) {
                    startPolling();
                }
            });

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ WebSocket
            socket.on('new_measurement', function(data) {
                console.log('üì® –ü–æ–ª—É—á–µ–Ω—ã real-time –¥–∞–Ω–Ω—ã–µ:', data);
                realtimeMessageCount++;
                updateRealtimeBadge();
                updateRealtimeTable(data);
                updateStats();
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ WebSocket
        function updateWebSocketStatus(connected) {
            const statusElement = document.getElementById('websocket-status');
            if (connected) {
                statusElement.className = 'websocket-connected';
                statusElement.innerHTML = '<i class="fas fa-plug"></i> WebSocket: ‚úÖ';
                statusElement.title = 'WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω';
            } else {
                statusElement.className = 'websocket-disconnected';
                statusElement.innerHTML = '<i class="fas fa-plug"></i> WebSocket: ‚ùå';
                statusElement.title = 'WebSocket –æ—Ç–∫–ª—é—á–µ–Ω';
            }
        }

        // –ó–∞–ø—É—Å–∫ polling –∫–∞–∫ fallback
        function startPolling() {
            console.log('üîÑ –ó–∞–ø—É—Å–∫ polling –∫–∞–∫ fallback...');
            pollingInterval = setInterval(() => {
                fetch('/api/historical?limit=5')
                    .then(response => response.json())
                    .then(data => {
                        if (data && data.length > 0) {
                            // –ë–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ —Å–∞–º—É—é —Å–≤–µ–∂—É—é –∑–∞–ø–∏—Å—å
                            const latest = data[0];
                            updateRealtimeTable(latest);
                            updateStats();
                        }
                    })
                    .catch(error => {
                        console.error('‚ùå –û—à–∏–±–∫–∞ polling:', error);
                    });
            }, 5000); // –ö–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–π–¥–∂–∞ real-time
        function updateRealtimeBadge() {
            const badge = document.getElementById('realtime-badge');
            badge.textContent = realtimeMessageCount;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            fetch('/api/stats')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('total-buildings').textContent = data.total_buildings;
                    document.getElementById('total-measurements').textContent = data.total_measurements;
                    document.getElementById('total-anomalies').textContent = data.anomalies;
                    document.getElementById('normal-count').textContent = data.normal;
                    document.getElementById('anomaly-percentage').textContent = data.anomaly_percentage + '%';
                    document.getElementById('update-time').textContent = new Date().toLocaleTimeString();

                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
                    const statusElement = document.getElementById('system-status');
                    if (data.anomaly_percentage > 20) {
                        statusElement.innerHTML = 'üî¥';
                        statusElement.title = '–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–Ω–æ–º–∞–ª–∏–π';
                    } else if (data.anomaly_percentage > 10) {
                        statusElement.innerHTML = 'üü°';
                        statusElement.title = '–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–Ω–æ–º–∞–ª–∏–π';
                    } else {
                        statusElement.innerHTML = 'üü¢';
                        statusElement.title = '–ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–Ω–æ–º–∞–ª–∏–π';
                    }
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
        function updateRealtimeTable(data) {
            const tbody = document.getElementById('realtime-data');
            const loadingRow = document.getElementById('realtime-loading');

            // –£–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
            if (loadingRow && tbody.contains(loadingRow)) {
                tbody.removeChild(loadingRow);
            }

            const newRow = document.createElement('tr');

            if (data.status.includes('üö®')) {
                newRow.className = 'anomaly';
            } else {
                newRow.className = 'normal';
            }

            // –û–ë–ù–û–í–õ–ï–ù–û: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–≤—É—Ö –∫–∞–Ω–∞–ª–æ–≤ –ì–í–°
            newRow.innerHTML = `
                <td>${data.address}</td>
                <td>${data.cold_water.toFixed(3)}</td>
                <td>${data.hot_water.toFixed(3)}</td>
                <td>${data.gvs_flow1 ? data.gvs_flow1.toFixed(3) : 'N/A'}</td>
                <td>${data.gvs_flow2 ? data.gvs_flow2.toFixed(3) : 'N/A'}</td>
                <td>${data.deviation.toFixed(2)}%</td>
                <td class="${data.status.includes('üö®') ? 'status-alert' : 'status-ok'}">${data.status}</td>
                <td>${new Date(data.timestamp).toLocaleString()}</td>
                <td>${data.scenario}</td>
            `;

            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –≤ –Ω–∞—á–∞–ª–æ
            tbody.insertBefore(newRow, tbody.firstChild);

            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 20)
            if (tbody.children.length > 20) {
                tbody.removeChild(tbody.lastChild);
            }
        }

        // –û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã real-time
        function clearRealtimeTable() {
            const tbody = document.getElementById('realtime-data');
            tbody.innerHTML = '';
            realtimeMessageCount = 0;
            updateRealtimeBadge();

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ —Å—Ç—Ä–æ–∫—É –∑–∞–≥—Ä—É–∑–∫–∏
            const loadingRow = document.createElement('tr');
            loadingRow.id = 'realtime-loading';
            loadingRow.innerHTML = `
                <td colspan="9" class="text-center">
                    <div class="spinner-border spinner-border-sm" role="status"></div>
                    –û–∂–∏–¥–∞–Ω–∏–µ real-time –¥–∞–Ω–Ω—ã—Ö...
                </td>
            `;
            tbody.appendChild(loadingRow);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö real-time –¥–∞–Ω–Ω—ã—Ö
        function loadLastRealtimeData() {
            fetch('/api/historical?limit=10')
                .then(response => response.json())
                .then(data => {
                    const tbody = document.getElementById('realtime-data');
                    const loadingRow = document.getElementById('realtime-loading');

                    if (loadingRow && tbody.contains(loadingRow)) {
                        tbody.removeChild(loadingRow);
                    }

                    // –û—á–∏—â–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∑–∞–ø–∏—Å–µ–π
                    tbody.innerHTML = '';
                    data.reverse().forEach(item => {
                        const row = document.createElement('tr');
                        if (item.status.includes('üö®')) {
                            row.className = 'anomaly';
                        } else {
                            row.className = 'normal';
                        }

                        // –û–ë–ù–û–í–õ–ï–ù–û: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–≤—É—Ö –∫–∞–Ω–∞–ª–æ–≤ –ì–í–°
                        row.innerHTML = `
                            <td>${item.address}</td>
                            <td>${item.cold_water.toFixed(3)}</td>
                            <td>${item.hot_water.toFixed(3)}</td>
                            <td>${item.gvs_flow1 ? item.gvs_flow1.toFixed(3) : 'N/A'}</td>
                            <td>${item.gvs_flow2 ? item.gvs_flow2.toFixed(3) : 'N/A'}</td>
                            <td>${item.deviation.toFixed(2)}%</td>
                            <td class="${item.status.includes('üö®') ? 'status-alert' : 'status-ok'}">${item.status}</td>
                            <td>${new Date(item.timestamp).toLocaleString()}</td>
                            <td>${item.scenario}</td>
                        `;
                        tbody.appendChild(row);
                    });
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö:', error);
                    alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ' + error.message);
                });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
        function loadHistoricalData() {
            const button = document.getElementById('historical-btn');
            const originalText = button.innerHTML;

            button.innerHTML = '<div class="spinner-border spinner-border-sm" role="status"></div> –ó–∞–≥—Ä—É–∑–∫–∞...';
            button.disabled = true;

            const limit = document.getElementById('history-limit').value;
            fetch(`/api/historical?limit=${limit}`)
                .then(response => response.json())
                .then(data => {
                    const tbody = document.getElementById('historical-data');
                    tbody.innerHTML = '';

                    data.forEach(item => {
                        const row = document.createElement('tr');
                        if (item.status.includes('üö®')) {
                            row.className = 'anomaly';
                        }

                        // –û–ë–ù–û–í–õ–ï–ù–û: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–≤—É—Ö –∫–∞–Ω–∞–ª–æ–≤ –ì–í–°
                        row.innerHTML = `
                            <td>${item.address}</td>
                            <td>${item.cold_water.toFixed(3)}</td>
                            <td>${item.hot_water.toFixed(3)}</td>
                            <td>${item.gvs_flow1 ? item.gvs_flow1.toFixed(3) : 'N/A'}</td>
                            <td>${item.gvs_flow2 ? item.gvs_flow2.toFixed(3) : 'N/A'}</td>
                            <td>${item.deviation.toFixed(2)}%</td>
                            <td class="${item.status.includes('üö®') ? 'status-alert' : 'status-ok'}">${item.status}</td>
                            <td>${new Date(item.timestamp).toLocaleString()}</td>
                            <td>${item.scenario}</td>
                        `;
                        tbody.appendChild(row);
                    });
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö:', error);
                    alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö: ' + error.message);
                })
                .finally(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∑–¥–∞–Ω–∏–π —Å –ò–¢–ü
        function loadBuildings() {
            const button = document.getElementById('buildings-btn');
            const originalText = button.innerHTML;

            button.innerHTML = '<div class="spinner-border spinner-border-sm" role="status"></div> –ó–∞–≥—Ä—É–∑–∫–∞...';
            button.disabled = true;

            fetch('/api/buildings')
                .then(response => response.json())
                .then(data => {
                    const tbody = document.getElementById('buildings-data');
                    tbody.innerHTML = '';

                    data.forEach(building => {
                        const row = document.createElement('tr');
                        // –û–ë–ù–û–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω –ò–¢–ü
                        row.innerHTML = `
                            <td>${building.building_id}</td>
                            <td>${building.address}</td>
                            <td>${building.itp_id || 'N/A'}</td>
                            <td>${building.total_measurements}</td>
                            <td>${building.anomaly_count}</td>
                            <td>${building.anomaly_percentage}%</td>
                            <td>${building.last_measurement ? new Date(building.last_measurement).toLocaleString() : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}</td>
                        `;
                        tbody.appendChild(row);
                    });
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∑–¥–∞–Ω–∏–π:', error);
                    alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞ –∑–¥–∞–Ω–∏–π: ' + error.message);
                })
                .finally(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–æ–¥–∫–∏ –ø–æ —Ä–∏—Å–∫–∞–º
        function loadRiskSummary() {
            fetch('/api/risk_summary')
                .then(response => response.json())
                .then(data => {
                    if (!data.error) {
                        document.getElementById('high-risk-count').textContent = data.high_risk_buildings;
                        document.getElementById('medium-risk-count').textContent = data.medium_risk_buildings;
                        document.getElementById('low-risk-count').textContent = data.low_risk_buildings;
                    }
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–æ–¥–∫–∏ —Ä–∏—Å–∫–æ–≤:', error);
                    // –ï—Å–ª–∏ endpoint –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥–ª—É—à–∫–∏
                    document.getElementById('high-risk-count').textContent = 'N/A';
                    document.getElementById('medium-risk-count').textContent = 'N/A';
                    document.getElementById('low-risk-count').textContent = 'N/A';
                });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ —Å –ò–¢–ü
        function loadPredictions() {
            const button = document.getElementById('predictions-btn');
            const originalText = button.innerHTML;

            button.innerHTML = '<div class="spinner-border spinner-border-sm" role="status"></div> –ó–∞–≥—Ä—É–∑–∫–∞...';
            button.disabled = true;

            fetch('/api/predictions')
                .then(response => response.json())
                .then(data => {
                    const tbody = document.getElementById('predictions-data');
                    tbody.innerHTML = '';

                    if (data.error) {
                        tbody.innerHTML = `<tr><td colspan="9" class="text-center">–û—à–∏–±–∫–∞: ${data.error}</td></tr>`;
                        return;
                    }

                    if (data.predictions && data.predictions.length > 0) {
                        data.predictions.forEach(prediction => {
                            const row = document.createElement('tr');

                            // –†–∞—Å–∫—Ä–∞—à–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞
                            if (prediction.risk_level === '–≤—ã—Å–æ–∫–∏–π') {
                                row.className = 'risk-high';
                            } else if (prediction.risk_level === '—Å—Ä–µ–¥–Ω–∏–π') {
                                row.className = 'risk-medium';
                            } else {
                                row.className = 'risk-low';
                            }

                            // –û–ë–ù–û–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω –ò–¢–ü
                            row.innerHTML = `
                                <td>${prediction.address}</td>
                                <td>${prediction.itp_id || 'N/A'}</td>
                                <td>
                                    <span class="badge ${prediction.risk_level === '–≤—ã—Å–æ–∫–∏–π' ? 'bg-danger' : prediction.risk_level === '—Å—Ä–µ–¥–Ω–∏–π' ? 'bg-warning' : 'bg-success'}">
                                        ${prediction.risk_level}
                                    </span>
                                </td>
                                <td>${(prediction.risk_score * 100).toFixed(1)}%</td>
                                <td>${prediction.hvs_value ? prediction.hvs_value.toFixed(3) : 'N/A'}</td>
                                <td>${prediction.gvs_value ? prediction.gvs_value.toFixed(3) : 'N/A'}</td>
                                <td>${prediction.deviation ? prediction.deviation.toFixed(2) + '%' : 'N/A'}</td>
                                <td>${prediction.last_measurement ? new Date(prediction.last_measurement).toLocaleString() : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}</td>
                                <td>
                                    <button class="btn btn-sm btn-info" onclick="getDetailedPrediction('${prediction.building_id}')">
                                        <i class="fas fa-search"></i> –î–µ—Ç–∞–ª–∏
                                    </button>
                                </td>
                            `;
                            tbody.appendChild(row);
                        });
                    } else {
                        tbody.innerHTML = `<tr><td colspan="9" class="text-center">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞</td></tr>`;
                    }
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤:', error);
                    const tbody = document.getElementById('predictions-data');
                    tbody.innerHTML = `<tr><td colspan="9" class="text-center">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤: ${error.message}</td></tr>`;
                })
                .finally(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                });
        }

        // –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –¥–ª—è –∑–¥–∞–Ω–∏—è
        function getDetailedPrediction(buildingId) {
            fetch(`/api/predictions/${buildingId}`)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        alert('–û—à–∏–±–∫–∞: ' + data.error);
                        return;
                    }

                    let message = `üè¢ –ó–¥–∞–Ω–∏–µ: ${data.building_id}\n`;
                    message += `üìä –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞: ${data.risk_level}\n`;
                    message += `üéØ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: ${(data.risk_score * 100).toFixed(1)}%\n`;
                    message += `üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: ${data.recommendation}\n`;
                    message += `‚è∞ –í—Ä–µ–º—è –ø—Ä–æ–≥–Ω–æ–∑–∞: ${new Date(data.timestamp).toLocaleString()}`;

                    alert(message);
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∞:', error);
                    alert('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∞');
                });
        }

        // –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        function trainModel() {
            fetch('/api/train_model')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        alert('‚úÖ ' + data.message);
                        // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–≥–Ω–æ–∑—ã –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è
                        setTimeout(loadPredictions, 2000);
                    } else {
                        alert('‚ùå ' + data.message);
                    }
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏:', error);
                    alert('–û—à–∏–±–∫–∞ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏: ' + error.message);
                });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤
        function loadCharts() {
            const buildingId = document.getElementById('building-select').value;
            const period = document.getElementById('period-select').value;

            loadConsumptionChart(buildingId, period);
            loadTrendChart(buildingId, period);
            loadRiskChart();
            loadHourlyChart(buildingId, period);
        }

        // –ì—Ä–∞—Ñ–∏–∫ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
        function loadConsumptionChart(buildingId, period) {
            fetch(`/api/charts/consumption?building_id=${buildingId}&period=${period}`)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è:', data.error);
                        return;
                    }

                    const ctx = document.getElementById('consumptionChart').getContext('2d');

                    if (consumptionChart) {
                        consumptionChart.destroy();
                    }

                    consumptionChart = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: ['–•–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞ (–•–í–°)', '–ì–æ—Ä—è—á–∞—è –≤–æ–¥–∞ (–ì–í–°)'],
                            datasets: [{
                                data: [data.consumption.hvs, data.consumption.gvs],
                                backgroundColor: ['#36a2eb', '#ff6384'],
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                },
                                title: {
                                    display: true,
                                    text: `–û–±—â–µ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ: ${(data.consumption.hvs + data.consumption.gvs).toFixed(1)} –º¬≥`
                                }
                            }
                        }
                    });

                    // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ –∞–Ω–æ–º–∞–ª–∏–π
                    updateAnomalyChart(data.anomalies);
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∞ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è:', error);
                });
        }

        // –ì—Ä–∞—Ñ–∏–∫ –∞–Ω–æ–º–∞–ª–∏–π
        function updateAnomalyChart(anomalyData) {
            const ctx = document.getElementById('anomalyChart').getContext('2d');

            if (anomalyChart) {
                anomalyChart.destroy();
            }

            const anomalyPercentage = (anomalyData.anomalies / anomalyData.total * 100).toFixed(1);

            anomalyChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['–ù–æ—Ä–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è', '–ê–Ω–æ–º–∞–ª–∏–∏'],
                    datasets: [{
                        data: [anomalyData.normal, anomalyData.anomalies],
                        backgroundColor: ['#4caf50', '#f44336'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: `–ê–Ω–æ–º–∞–ª–∏–π: ${anomalyPercentage}%`
                        }
                    }
                }
            });
        }

        // –ì—Ä–∞—Ñ–∏–∫ —Ç—Ä–µ–Ω–¥–∞
        function loadTrendChart(buildingId, period) {
            fetch(`/api/charts/trend?building_id=${buildingId}&period=${period}`)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç—Ä–µ–Ω–¥–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:', data.error);
                        return;
                    }

                    const ctx = document.getElementById('trendChart').getContext('2d');
                    const dates = data.daily_data.map(item => item.date);
                    const hvsData = data.daily_data.map(item => item.hvs);
                    const gvsData = data.daily_data.map(item => item.gvs);

                    if (trendChart) {
                        trendChart.destroy();
                    }

                    trendChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: dates,
                            datasets: [
                                {
                                    label: '–•–í–°',
                                    data: hvsData,
                                    borderColor: '#36a2eb',
                                    backgroundColor: 'rgba(54, 162, 235, 0.1)',
                                    tension: 0.4,
                                    fill: true
                                },
                                {
                                    label: '–ì–í–°',
                                    data: gvsData,
                                    borderColor: '#ff6384',
                                    backgroundColor: 'rgba(255, 99, 132, 0.1)',
                                    tension: 0.4,
                                    fill: true
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'top'
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: '–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ (–º¬≥)'
                                    }
                                }
                            }
                        }
                    });
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∞ —Ç—Ä–µ–Ω–¥–∞:', error);
                });
        }

        // –ì—Ä–∞—Ñ–∏–∫ —Ä–∏—Å–∫–æ–≤
        function loadRiskChart() {
            fetch('/api/charts/risks')
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤:', data.error);
                        return;
                    }

                    const ctx = document.getElementById('riskChart').getContext('2d');
                    const addresses = data.risk_data.map(item => item.address);
                    const risks = data.risk_data.map(item => item.risk_score);
                    const colors = data.risk_data.map(item =>
                        item.risk_category === '–≤—ã—Å–æ–∫–∏–π' ? '#f44336' :
                        item.risk_category === '—Å—Ä–µ–¥–Ω–∏–π' ? '#ff9800' : '#4caf50'
                    );

                    if (riskChart) {
                        riskChart.destroy();
                    }

                    riskChart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: addresses,
                            datasets: [{
                                label: '–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞ (%)',
                                data: risks,
                                backgroundColor: colors,
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 100,
                                    title: {
                                        display: true,
                                        text: '–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞ (%)'
                                    }
                                }
                            }
                        }
                    });
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–∏—Å–∫–æ–≤:', error);
                });
        }

        // –ì—Ä–∞—Ñ–∏–∫ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
        function loadHourlyChart(buildingId, period) {
            // –í—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è - –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            const ctx = document.getElementById('hourlyChart').getContext('2d');
            const hours = Array.from({length: 24}, (_, i) => i);
            const mockData = hours.map(hour =>
                Math.sin(hour * Math.PI / 12) * 50 + 50 + Math.random() * 20
            );

            if (hourlyChart) {
                hourlyChart.destroy();
            }

            hourlyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: hours.map(h => h + ':00'),
                    datasets: [{
                        label: '–°—Ä–µ–¥–Ω–µ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ',
                        data: mockData,
                        borderColor: '#9c27b0',
                        backgroundColor: 'rgba(156, 39, 176, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ (%)'
                            }
                        }
                    }
                }
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∑–¥–∞–Ω–∏–π –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞
        function loadBuildingOptions() {
            fetch('/api/charts/buildings')
                .then(response => response.json())
                .then(data => {
                    const select = document.getElementById('building-select');
                    select.innerHTML = '';

                    if (data.buildings) {
                        data.buildings.forEach(building => {
                            const option = document.createElement('option');
                            option.value = building.id;
                            option.textContent = building.address;
                            select.appendChild(option);
                        });
                    }
                })
                .catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞ –∑–¥–∞–Ω–∏–π:', error);
                });
        }

        // –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        function testConnection() {
            const tests = [
                fetch('/health').then(r => r.json()),
                fetch('/api/stats').then(r => r.json()),
                fetch('/api/historical?limit=1').then(r => r.json())
            ];

            Promise.all(tests)
                .then(results => {
                    const health = results[0];
                    const stats = results[1];
                    const historical = results[2];

                    let message = `‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç:\n`;
                    message += `- Health: ${health.status}\n`;
                    message += `- Kafka: ${health.kafka_connected ? '‚úÖ' : '‚ùå'}\n`;
                    message += `- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ${health.database_connected ? '‚úÖ' : '‚ùå'}\n`;
                    message += `- Redis: ${health.redis_connected ? '‚úÖ' : '‚ùå'}\n`;
                    message += `- –í—Å–µ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π: ${stats.total_measurements}\n`;
                    message += `- WebSocket: ${socket && socket.connected ? '‚úÖ' : '‚ùå'}\n`;
                    message += `- –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: ${realtimeMessageCount}`;

                    alert(message);
                })
                .catch(error => {
                    alert('‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ' + error.message);
                });
        }

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');

            // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
            checkAuth();
        });
    </script>
</body>
</html>